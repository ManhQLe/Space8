function Space8(a){Space8.baseConstructor.call(this,a);this.Prop("VPPos",[0,0]);this.Prop("ZoomScale",1);this.Prop("VPSize",[800,800])}WebCtrl8.ExtendsTo(Space8);
Space8.Util={EnableSpan:function(a,b){var c;a.addEventListener("mousemove",function(d){d=window.event||d;if(1==d.buttons){var e=Space8.Util.MouseXY(a,d);b.apply(a,[d,{dx:e[0]-c[0],dy:e[1]-c[1],m1:[c[0],c[1]],m2:[e[0],e[1]]}]);c=e}else c=Space8.Util.MouseXY(a,d);d.stopPropagation();d.preventDefault()})},MouseXY:function(a,b){var c=a.getBoundingClientRect();return[b.clientX-c.left,b.clientY-c.top]}};Space8.prototype.SpanTo=function(a,b){this.VPPos[0]=a;this.VPPos[1]=b;this.UpdateTransform()};
Space8.prototype.UpdateTransform=function(){};Space8.prototype.Span=function(a,b,c){c?(a=this.WorldScale(a),b=this.WorldScale(b)):1;this.SpanTo(this.VPPos[0]+a,this.VPPos[1]+b)};Space8.prototype.ZoomTo=function(a,b){var c;b&&(c=this.View2World(b));this.ZoomScale=1E-8>=a?1:a;c&&(c=this.World2View(c),c=this.WorldScaleV([c[0]-b[0],c[1]-b[1]]),this.VPPos[0]+=c[0],this.VPPos[1]+=c[1]);this.UpdateTransform()};
Space8.prototype.ZoomRect=function(a,b,c,d,e){var f;a>c?(f=a,a=c,c=f):0;b>d?(f=b,b=d,d=f):0;c=[c-a,d-b];d=[a,b];e&&(d=this.View2World([a,b]),c=this.WorldScaleV(c));a=this.WorldScaleV(this.VPSize);this.ZoomScale=c[0]>c[1]?a[0]/c[0]:a[1]/c[1];this.VPPos[0]=d[0];this.VPPos[1]=d[1];this.UpdateTransform()};Space8.prototype.Center=function(a){this.Span((a[0]-(this.VPPos[0]+.5*this.VPSize[0]))/this.ZoomScale,(a[1]-(this.VPPos[1]+.5*this.VPSize[1]))/this.ZoomScale)};
Space8.prototype.Zoom=function(a,b){this.ZoomTo(this.ZoomScale+a,b)};Space8.prototype.SetSize=function(a){this.VPSize=a;this.UpdateTransform()};Space8.prototype.WorldScale=function(a){return a/this.ZoomScale};Space8.prototype.WorldScaleV=function(a){var b=1/this.ZoomScale;return[a[0]*b,a[1]*b]};Space8.prototype.ViewScale=function(a){return a*this.ZoomScale};Space8.prototype.ViewScaleV=function(a){return[a[0]*this.ZoomScale,a[1]*this.ZoomScale]};
Space8.prototype.World2View=function(a){var b=(a[1]-this.VPPos[1])*this.ZoomScale;return[(a[0]-this.VPPos[0])*this.ZoomScale,this.Cartesian?this.VPSize[1]-b:b]};Space8.prototype.View2World=function(a){return[a[0]/this.ZoomScale+this.VPPos[0],(this.Cartesian?this.VPSize[1]-a[1]:a[1])/this.ZoomScale+this.VPPos[1]]};function Html8(a,b){Html8.baseConstructor.call(this,a,b)}Space8.ExtendsTo(Html8);
Html8.prototype.SetupCanvas=function(){this.DOM.style.overflow="hidden";this.SPACE=document.createElement("div");this.SPACE.setAttribute("space8","");this.SPACE.style.position="relative";this.SPACE.style["transform-origin"]="left top";for(var a=this.DOM.childNodes;a.length;)this.SPACE.appendChild(a[0]);this.DOM.appendChild(this.SPACE)};Html8.prototype.Center=function(a){this.Span((a[0]-(this.VPPos[0]+.5*this.VPSize[0]))/this.ZoomScale,(a[1]-(this.VPPos[1]+.5*this.VPSize[1]))/this.ZoomScale)};
Html8.prototype.UpdateTransform=function(){this.SPACE.style.transform="translate("+-this.VPPos[0]*this.ZoomScale+"px,"+-this.VPPos[1]*this.ZoomScale+"px)scale("+this.ZoomScale+","+(this.Cartesian?-1:1)*this.ZoomScale+")";this.DOM.style.width=this.VPSize[0]+"px";this.DOM.style.height=this.VPSize[1]+"px"};function Svg8(a){Svg8.baseConstructor.call(this,a);this.SetupCanvas()}Space8.ExtendsTo(Svg8);
Svg8.prototype.SetupCanvas=function(){("string"==typeof this.DOM?document.querySelector(this.DOM):this.DOM).setAttribute("preserveAspectRatio","xMinYMin slice");this.UpdateTransform()};
Svg8.prototype.UpdateTransform=function(){var a=[this.VPPos[0],this.Cartesian?-this.VPPos[1]-this.VPSize[1]/this.ZoomScale:this.VPPos[1],this.VPSize[0]/this.ZoomScale,this.VPSize[1]/this.ZoomScale],b="string"==typeof this.DOM?document.querySelector(this.DOM):this.DOM;b.setAttribute("viewBox",a.join(" "));b.style.width=this.VPSize[0]+"px";b.style.height=this.VPSize[1]+"px"};
